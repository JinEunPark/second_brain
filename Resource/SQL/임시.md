
https://school.programmers.co.kr/learn/courses/30/lessons/59044

```sql
select i.name, i.datetime
from animal_ins i
left outer join animal_outs o on o.animal_id = i.animal_id
where isnull(o.datetime) = true 
order by i.datetime asc
limit 3;
```



https://school.programmers.co.kr/learn/courses/30/lessons/59045

```sql
select i.animal_id, i.animal_type, i.name
from animal_ins i
join animal_outs o on i.animal_id = o.animal_id
where (o.SEX_UPON_OUTCOME = "Spayed Female" or o.SEX_UPON_OUTCOME = "Neutered Male") 
    and (i.sex_upon_intake = "Intact Male" or i.sex_upon_intake = "Intact Female") 
order by i.animal_id asc;
```

https://school.programmers.co.kr/learn/courses/30/lessons/131533

```sql
select p.product_code, (p.price*s.sums) as sales
from (select product_id, sum(sales_amount) as sums
     from offline_sale
     group by product_id) s
join product p on p.product_id = s.product_id
order by sales desc, p.product_code asc;
```


https://school.programmers.co.kr/learn/courses/30/lessons/131534

```sql
set @total_user := 0;
select @total_user:= count(*)
from user_info u
where year(u.joined) = 2021;

select 
    year(o.sales_date) as year, 
    month(o.sales_date) as month, 
    count(distinct o.user_id) as puchased_users, 
    round(count(distinct o.user_id)/@total_user,1) as puchased_ratio
    
from online_sale o
join user_info u on u.user_id = o.user_id
where year(u.joined) = 2021
group by year,month;
```


### 지역 변수 
~~~sql
set @total_user := 0;
select @total_user:= count(*)
from user_info u
where year(u.joined) = 2021;
~~~

지역 변수를 만들어서 2021 년에 가입한 총 user 의 수를 구했다

그리고 이후에 

```sql
select 
    year(o.sales_date) as year, 
    month(o.sales_date) as month, 
    count(distinct o.user_id) as puchased_users, 
    round(count(distinct o.user_id)/@total_user,1) as puchased_ratio
    
from online_sale o
join user_info u on u.user_id = o.user_id
where year(u.joined) = 2021
group by year,month;
```
